<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>New methods • tactile</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="New methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tactile</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/new-high-level-functions.html">New high-level functions</a></li>
    <li><a class="dropdown-item" href="../articles/new-methods.html">New methods</a></li>
    <li><a class="dropdown-item" href="../articles/new-panel-functions.html">New panel functions</a></li>
    <li><a class="dropdown-item" href="../articles/tactile-theme.html">The tactile theme</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jolars/tactile/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>New methods</h1>
            <h3 data-toc-skip class="subtitle">tactile</h3>
                        <h4 data-toc-skip class="author">Johan
Larsson</h4>
            
            <h4 data-toc-skip class="date">2025-07-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jolars/tactile/blob/master/vignettes/new-methods.Rmd" class="external-link"><code>vignettes/new-methods.Rmd</code></a></small>
      <div class="d-none name"><code>new-methods.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="xyplot-lm-linear-model-diagnostics">
<code>xyplot.lm()</code>: Linear model diagnostics<a class="anchor" aria-label="anchor" href="#xyplot-lm-linear-model-diagnostics"></a>
</h2>
<p>tactile provides an <code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot()</a></code> method for <code>lm</code>
objects – usually generated with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> or
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>. It provides the same type of diagnostic plots
that <code><a href="https://rdrr.io/r/stats/plot.lm.html" class="external-link">stats::plot.lm()</a></code> covers, with some small modifications
This method is provided so that a user may use lattice graphics
throughout out a</p>
<p>document, say for a lab report, and produce consistent graphic
material that can be changed on a general level (for instance by using
<code><a href="https://rdrr.io/pkg/lattice/man/lattice.options.html" class="external-link">lattice.options()</a></code>).</p>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p>We fit a simple linear model</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p>Here, we fist use the default option and plot the diagnostics using
<code>stats::plot()</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="new-methods_files/figure-html/unnamed-chunk-2-1.png" alt="Plot diagnostics with `stats::plot.lm()`." width="576"><p class="caption">
Plot diagnostics with <code><a href="https://rdrr.io/r/stats/plot.lm.html" class="external-link">stats::plot.lm()</a></code>.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Or instead use the method provided by tactile.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jolars/tactile" class="external-link">tactile</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="new-methods_files/figure-html/unnamed-chunk-3-1.png" alt="Plot diagnostics with `xyplot.lm()`." width="576"><p class="caption">
Plot diagnostics with <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code>.
</p>
</div>
<p>You will see that the results are similar. The benefits, however, of
using <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code> from tactile are that</p>
<ul>
<li>handling of plot margins is much improved,</li>
<li>the plots are returned as a list of trellis objects (that can be
updated),</li>
<li>general plot settings from <code>lattice</code> are respected
(mostly), and</li>
<li>you no longer have to specify <code>par(mfrow = c(2, 2))</code>. The
plots are arranged via <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">gridExtra::grid.arrange()</a></code>
automatically and arguments <code>nrow</code> and <code>ncol</code> have
been made accessible in the <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code> call to enable
manual specifications.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="xyplot-arima-arima-model-diagnostics">
<code>xyplot.Arima</code>: ARIMA Model Diagnostics<a class="anchor" aria-label="anchor" href="#xyplot-arima-arima-model-diagnostics"></a>
</h2>
<p>This function is similar to <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code> but is modeled
after <code><a href="https://rdrr.io/r/stats/tsdiag.html" class="external-link">stats::tsdiag()</a></code>. First, we look at the output from
the original.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></span><span class="op">(</span><span class="va">lh</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/tsdiag.html" class="external-link">tsdiag</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
<p>To use the method from tactile, we just call <code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot()</a></code> on
the model fit. The most prominent difference here is that we’ve added a
Q-Q plot of the standardized residuals as well, but also that we’re
correcting the Ljung–Box test to account for the fact that we’ve fit a
model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="xyplot-forecast-plotting-forecasts-with-tactile">
<code>xyplot.forecast()</code>: Plotting forecasts with tactile<a class="anchor" aria-label="anchor" href="#xyplot-forecast-plotting-forecasts-with-tactile"></a>
</h2>
<p>Robert Hyndman’s excellent <a href="https://cran.r-project.org/package=forecast" class="external-link">forecast</a> package
has built-in functions for plotting forecasts. These have been reworked
to use lattice graphics in tactile, and also try to place the forecasts
on the time scale of the original data (if such is provided).</p>
<p>For this example, we user <code>USAccDeaths</code>, a time series
giving the monthly totals of accidental deaths in the USA. We begin by
separating the series into a training and test set.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/" class="external-link">forecast</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">USAccDeaths</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1973</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1977</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">USAccDeaths</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1978</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1978</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we fit the model and plot the results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></span><span class="op">(</span><span class="va">train</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, seasonal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fcast1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">fcast1</span>, <span class="va">test</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>, auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>corner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ci_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"PI Level"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>A so called fan plot can be achieved by increasing the number of
prediction intervals in the call to <code>forecast</code>. We also
switch to a separate color palette by using the <code>ci_pal</code>
argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A fan plot</span></span>
<span><span class="va">fcast2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fl">12</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">95</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">fcast2</span>, <span class="va">test</span>, ci_pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johan Larsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
